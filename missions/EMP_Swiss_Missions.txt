swiss_parliament_missions_1 = {
	slot = 1
	generic = no
	ai = yes
	potential_on_load = {
		 has_dlc = "Emperor"
	}
	potential = {
		tag = SWI
		NOT = { map_setup = map_setup_random }
		has_dlc = "Emperor"
	}
	has_country_shield = yes
	
	swi_preis_stabilite = {
		icon = vaud_and_wallis
		required_missions = { swi_stability_act }
		position = 2
		provinces_to_highlight = {
			province_id = 165	# Bern
			OR = {
				NOT = { owned_by = ROOT}
				NOT = { is_core = ROOT }
			}
		}
		trigger = {
			165 = {		# Bern
				owned_by = ROOT
				is_core = ROOT
			}
			is_year = 1494
			is_at_war = no
			NOT = { had_recent_war = 50 }
			has_country_flag = swi_stability_act_passed
		}
		effect = {
			165 ={		# Bern
				add_province_triggered_modifier = swi_peace_finance_modifier
				add_province_triggered_modifier = swi_price_stabilite_modifier
			}
		}
	}
}

swiss_maritime_missions_1 = {
	slot = 1
	generic = no
	ai = yes
	potential_on_load = {
		 has_dlc = "Emperor"
	}
	potential = {
		tag = SWI
		NOT = { map_setup = map_setup_random }
		has_dlc = "Emperor"
	}
	has_country_shield = yes

	swi_revive_maritime_spirit = {
		icon = vaud_and_wallis
		required_missions = { }
		position = 3
		provinces_to_highlight = {
			province_id = 2986 	# Cagliari
			2986 = {
				owner = {
					NOT = { gives_fleet_basing_rights_to = ROOT }
				}
			}
		}
		trigger = {
			has_idea = maritime_mercantilism
			2986 = {	# Cagliari
				owner = {
					gives_fleet_basing_rights_to = ROOT
				}
			}
		}
		effect = {
			set_country_flag = swi_can_buy_ships
			2986 = {
				save_global_event_target_as = swi_ship_construction_port
			}
		}
	}

	swi_geneva_sail = {
		icon = vaud_and_wallis
		required_missions = { swi_revive_maritime_spirit 
							  swi_promote_city_growth}
		position = 4
		provinces_to_highlight = {
			province_id = 4720
			OR = {
				NOT = {owned_by = ROOT}
				NOT = {is_core = ROOT}
				NOT = {base_production = 18}
				has_manufactory_trigger = no
				has_production_building_trigger = no
			}
		}
		trigger = {
			4720 = {	# Geneva
				owned_by = ROOT
				is_core = ROOT
				base_production = 18
				has_manufactory_trigger = yes
				has_production_building_trigger = yes
			}
		}
		effect = {
			4720 = { 	# Geneva
				add_or_upgrade_production_building = yes
			}
			# TODO maybe add a temporary naval maintainance reduction
		}
	}

	swi_maritime_academy = {
		icon = vaud_and_wallis
		required_missions = { swi_geneva_sail }
		position = 5
		trigger = {
			navy_size_percentage = 0.7
			treasury = 500
		}
		effect = {
			add_treasury = -500
			set_country_flag = swi_marine_academy_build_flag
			4720 = { 	# Geneva
				add_great_project = {
					type = swi_marine_academy
				}
			}
			
		}
	}

	swi_landing_exercises = {
		icon = vaud_and_wallis
		required_missions = { swi_maritime_academy }
		position = 6
		provinces_to_highlight = {
			province_id = 4720
			OR = {
				NOT = { owned_by = ROOT }
				NOT = { is_core = ROOT }
				NOT = { base_manpower = 15 }
			}
		}
		trigger = {
			has_country_flag = swi_mercenary_act_passed
			num_of_transport = 10
			4720 = { 	# Geneva
				owned_by = ROOT
				is_core = ROOT
				base_manpower = 15
			}
			event_target:swi_ship_construction_port = {	# unless changed it is Cagliari
				owner = {
					has_opinion ={
						who = ROOT
						value = 100
					}
				}
			}
		}
		effect = {
			4720 = { 	# Geneva
				# TODO merc stuff
			}
			
		}
	}
}
swiss_mountain_missions_1 = {
	slot = 1
	generic = no
	ai = yes
	potential_on_load = {
		 has_dlc = "Emperor"
	}
	potential = {
		tag = SWI
		NOT = { map_setup = map_setup_random }
		has_dlc = "Emperor"
	}
	has_country_shield = yes

	swi_strike_the_iron = {
		icon = vaud_and_wallis
		required_missions = { swi_utilize_mountains }
		position = 7
		provinces_to_highlight = {
			OR = {
				province_id = 165
				province_id = 166
			}
			OR = {
				NOT = {owned_by = ROOT}
				NOT = {is_core = ROOT}
				NOT ={ base_production = 10 }
				has_manufactory_trigger = no
				has_production_building_trigger = no
			} 
		}
		trigger = {
			165 = { 	# Bern
				owned_by = ROOT
				is_core = ROOT
				base_production = 10
				has_manufactory_trigger = yes
				has_production_building_trigger = yes
			}
			166 = {		# Waldstätte
				owned_by = ROOT
				is_core = ROOT
				base_production = 10
				has_manufactory_trigger = yes
				has_production_building_trigger = yes
			}
		}
		effect = {
			# TODO add custom tooltip
			set_country_flag = swi_strike_the_iron_flag
		}
	}
}
swiss_parliament_missions_2 = {
	slot = 2
	generic = no
	ai = yes
	potential_on_load = {
		 has_dlc = "Emperor"
	}
	potential = {
		tag = SWI
		NOT = { map_setup = map_setup_random }
		has_dlc = "Emperor"
	}
	has_country_shield = yes

	swi_stability_act = {
		icon = vaud_and_wallis
		required_missions = { }
		position = 1
		trigger = {
			is_year = 1454
			stability = 3
			is_at_war = no
			NOT = { had_recent_war = 10 }
		}
		effect = {
			unlock_issue = {
				issue = swi_stability_act
			}
		}
	}
}

swiss_city_missions_2 = {
	slot = 2
	generic = no
	ai = yes
	potential_on_load = {
		 has_dlc = "Emperor"
	}
	potential = {
		tag = SWI
		NOT = { map_setup = map_setup_random }
		has_dlc = "Emperor"
	}
	has_country_shield = yes

	swi_quarries = {
		icon = vaud_and_wallis
		required_missions = { }
		position = 2
		provinces_to_highlight = {
			owned_by = ROOT
			has_terrain = mountain
			OR ={
				NOT = { grown_by_development = 3 }
			}
		}
		trigger = {
			custom_trigger_tooltip = {
				tooltip = swi_quarries_tooltip
				all_owned_province = {
					if = {
						limit = {
							has_terrain = mountain
						}
						grown_by_development = 3
					}
				}
			}
			
			
		}
		effect = {
			add_country_modifier = {
				name = swi_building_supplies_modifier
				duration = 7300		# 20 Years
			}
		}
	}

	swi_promote_city_growth = {
		icon = vaud_and_wallis
		required_missions = { swi_quarries }
		position = 3
		provinces_to_highlight = {
			owned_by = ROOT
			NOT = {
				has_terrain = mountain
			}
			OR ={
				has_production_building_trigger = no
				NOT = { grown_by_development = 3 }
				NOT = { num_of_buildings_in_province = 2 }
				NOT ={ num_of_times_expanded_infrastructure = 1 }
			}
		}
		trigger = {
			custom_trigger_tooltip = {
				tooltip = swi_promote_city_growth_tooltip
				all_owned_province = {
					if = {
						limit = {
							NOT = {
								has_terrain = mountain
							}
						}
						grown_by_development = 3
						has_production_building_trigger = yes
						num_of_buildings_in_province = 2
						num_of_times_expanded_infrastructure = 1
					}
				}
			}
			treasury = 200
		}
		effect = {
			add_treasury = -200
			add_country_modifier = {
				name = swi_city_expansion_modifier
				duration = 7300		# 20 Years
			}
		}
	}

	swi_cheese = {
		icon = vaud_and_wallis
		required_missions = { swi_promote_city_growth }
		position = 4
		provinces_to_highlight = {
			owned_by = ROOT
			trade_goods = livestock
			OR ={
				has_manufactory_trigger = no
				has_production_building_trigger = no
				NOT = { base_production = 15 }
			}
		}
		trigger = {
			custom_trigger_tooltip = {
				tooltip = swi_cheese_tooltip
				all_owned_province = {
					if = {
						limit = {
							trade_goods = livestock
						}
						has_manufactory_trigger = yes
						has_production_building_trigger = yes
						base_production = 15
					}
				}
			}
			treasury = 200
		}
		effect = {
			every_owned_province = {
				if = {
					limit = {
						trade_goods = livestock
					}
					add_province_modifier = {
						name = swi_cheese_modifier 	# Would probably be better to tie it into a gov form or a privelege
						duration = -1				# so it gets auto removed if trade good changes or something?
					}
				}
			}
		}
	}
}

swiss_maritime_missions_2 = {
	slot = 2
	generic = no
	ai = yes
	potential_on_load = {
		 has_dlc = "Emperor"
	}
	potential = {
		tag = SWI
		NOT = { map_setup = map_setup_random }
		has_dlc = "Emperor"
	}
	has_country_shield = yes

	swi_sell_our_cloth = {
		icon = vaud_and_wallis
		required_missions = { swi_geneva_sail }
		position = 5
		provinces_to_highlight = {
			owned_by = ROOT
			trade_goods = cloth
			OR ={
				has_manufactory_trigger = no
				has_production_building_trigger = no
				has_trade_building_trigger = no
				NOT = { base_production = 18 }
			}
		}
		trigger = {
			has_institution = global_trade
			num_of_light_ship = 10
			custom_trigger_tooltip = {
				tooltip = swi_sell_our_cloth_tooltip
				all_owned_province = {
					if = {
						limit = { trade_goods = cloth }
						has_manufactory_trigger = yes
						has_production_building_trigger = yes
						has_trade_building_trigger = yes
						base_production = 18
					}
				}
			}
		}
		effect = {
			add_years_of_owned_provinces_production_income = {
				years = 1
				trigger = {
					trade_goods = cloth
				}
			} 
			186 = { 	# Paris (Champagne trade node)
				add_trade_modifier = {
					who = ROOT
					duration = 18250	# 50 Years
					power = 25
					key = swi_cloth_sale_trade_modifier
				}
			}

			1869 = {	# Frankfurt (Rheinland Trade Node)
				add_trade_modifier = {
					who = ROOT
					duration = 18250	# 50 Years
					power = 25
					key = swi_cloth_sale_trade_modifier
				}
			}

			1298 = {	# Ligurian See (Genoa trade node)
				add_trade_modifier = {
					who = ROOT
					duration = 18250	# 50 Years
					power = 25
					key = swi_cloth_sale_trade_modifier
				}
			}
			134 = { 	# Wien (Wien trade node)
				add_trade_modifier = {
					who = ROOT
					duration = 18250	# 50 Years
					power = 25
					key = swi_cloth_sale_trade_modifier
				}
			}
		}
	}
}

swiss_mountain_missions_2 = {
	slot = 2
	generic = no
	ai = yes
	potential_on_load = {
		 has_dlc = "Emperor"
	}
	potential = {
		tag = SWI
		NOT = { map_setup = map_setup_random }
		has_dlc = "Emperor"
	}
	has_country_shield = yes

	swi_utilize_mountains = {
		icon = vaud_and_wallis
		required_missions = { }
		position = 6
		provinces_to_highlight = {
			owned_by = ROOT
			has_terrain = mountain
			OR = {
				NOT = { num_of_buildings_in_province = 1 }
				NOT = { num_of_times_expanded_infrastructure = 1 }
			}
		}
		trigger = {
			custom_trigger_tooltip = {
				tooltip = swi_utilize_mountains_tooltip
				all_owned_province = {
					if = {
						limit = {
							has_terrain = mountain
						}
						num_of_buildings_in_province = 1
						num_of_times_expanded_infrastructure = 1
					}
				}
			}
			
			treasury = 200
		}
		effect = {
			add_treasury = -200
			unlock_estate_privilege = {
					estate_privilege = estate_burghers_mountain_expansion
			}

		}
	}

	swi_eizenbergwerk_gonzen = {
		icon = vaud_and_wallis
		required_missions = { swi_utilize_mountains }
		position = 7
		provinces_to_highlight = {
			province_id = 1870
			OR = {
				NOT = {owned_by = ROOT}
				NOT = {is_core = ROOT}
				NOT ={ base_production = 15 }
				has_manufactory_trigger = no
				has_production_building_trigger = no
				NOT = { manufactories = 1 }
			} 
		}
		trigger = {
			1870 = { 	# St.Gallen
				owned_by = ROOT
				is_core = ROOT
				base_production = 15
				has_manufactory_trigger = yes
				has_production_building_trigger = yes
				manufactories = 1
			}
		}
		effect = {
			1870 = { 	# St.Gallen
				change_trade_goods = iron
				remove_building = manufactory
				add_building = weapons
				# TODO Remove this if cheese modifier gets reworked
				if = {
					limit = {
						has_province_modifier = swi_cheese_modifier
					}
					remove_province_modifier = swi_cheese_modifier
				}
				add_province_modifier = {
					name = swi_eizenbergwerk_gonzen_modifier
					duration = -1
				}
			}
			
		}
	}
}
swiss_parliament_missions_3 = {
	slot = 3
	generic = no
	ai = yes
	potential_on_load = {
		 has_dlc = "Emperor"
	}
	potential = {
		tag = SWI
		NOT = { map_setup = map_setup_random }
		has_dlc = "Emperor"
	}
	has_country_shield = yes

	swi_tolerance_act = {
		icon = vaud_and_wallis
		required_missions = { }
		position = 1
		trigger = {
			NOT = {
				current_age = age_of_discovery
			}
			OR = {
				has_estate_privilege = estate_burghers_enforced_interfaith_dialogue
				AND = {		# Introduced a failsafe If I somehow don't get touched by the reformation
					OR = {
						current_age = age_of_absolutism
						current_age = age_of_revolutions
					}
					all_owned_province = {
						has_owner_religion = yes
					}
				}
			}
			OR = {
				AND = {
					NOT = {
						estate_influence = {
							estate = estate_church
							influence = 20		# Decreased as per robo's comment
						}
					}
					estate_loyalty = {
						estate = estate_church
						loyalty = 60
					}
					crown_land_share = estate_church	# Also introduced to make harder
				}
				has_reform = curtail_clergy_power_reform
			}
		}
		effect = {
			unlock_issue = {
				issue = swi_tolerance_act
			}
			# TODO improve the Estate Interfaith Privelege if passes
		}
	}

	swi_state_act = {
		icon = vaud_and_wallis
		required_missions = { swi_stability_act 
							  swi_tolerance_act
							  swi_mercenary_act
		 					}
		position = 2
		trigger = {
			OR = {
				current_age = age_of_absolutism
				current_age = age_of_revolutions
			}
			has_reform = centralize_reform
			OR = {
				has_reform = superiority_of_the_state_reform
				has_reform = dyanstic_administration_reform
			}
			crown_land_share = estate_church	# on robo's suggestion
			crown_land_share = estate_nobles
			crown_land_share = estate_burghers
		}
		effect = {
			add_country_modifier = {
				name = swi_controversial_debate
				duration = -1
			}
			unlock_issue = {
				issue = swi_state_act
			}
			# TODO parliamentary stuff
		}
	}
}

swiss_university_missions_3 = {
	slot = 3
	generic = no
	ai = yes
	potential_on_load = {
		 has_dlc = "Emperor"
	}
	potential = {
		tag = SWI
		NOT = { map_setup = map_setup_random }
		has_dlc = "Emperor"
	}
	has_country_shield = yes

	swi_sanction_basel = {
		icon = vaud_and_wallis
		required_missions = { swi_swiss_guard }
		position = 3
		provinces_to_highlight = {
			OR = {
				AND = {
					province_id = 1869	# Zürich (rp wise also Basel)
					NOT = {
						AND = {
							owned_by = ROOT
							has_tax_building_trigger = yes
						}
					}
				}
				AND = {
					owned_by = PAP
					NOT = {
						owner = {
							has_opinion = {
								who = ROOT
								value = 100
							}
							OR ={
								alliance_with = ROOT
								guaranteed_by = ROOT
							}
						}
					}
				}
			}
			
		}
		trigger = {
			if = {
				limit = { exists = PAP}
				PAP = {
					has_opinion = {
						who = ROOT
						value = 100
					}
					OR ={
						alliance_with = ROOT
						guaranteed_by = ROOT
					}
				}
			}
			papal_influence = 50
			1869 ={	# Zürich (rp wise also Basel)
				owned_by = ROOT
				has_tax_building_trigger = yes
			}
			treasury = 100
		}
		effect = {
			add_papal_influence = -50
			add_treasury = -100
			1869 ={	# Zürich (rp wise also Basel)
				add_cardinal = yes
				add_province_modifier = {
					name = swi_papal_lecturers	# making the province unconvertible seems like the only way to prevent centre conversion
					duration = -1
				}
			}
		}
	}

	swi_expand_university = {
		icon = vaud_and_wallis
		required_missions = { 
							  swi_sanction_basel
							  swi_promote_city_growth
							}
		position = 4
		provinces_to_highlight = {
			province_id = 1869	# Zürich (rp wise also Basel)
			NOT = {
				AND = {
					owned_by = ROOT
					renaissance = 100
					development = 30
				}
			}
		}
		trigger = {
			treasury = 400
			has_institution = renaissance
			1869 ={	# Zürich (rp wise also Basel)
				owned_by = ROOT
				renaissance = 100
				development = 30
			}
		}
		effect = {
			add_treasury = -400
			1869 ={	# Zürich (rp wise also Basel)
				add_building = university
			}
			change_innovativeness =  5
		}
	}

	swi_print_research = {
		icon = vaud_and_wallis
		required_missions = { swi_expand_university }
		position = 5
		provinces_to_highlight = {
			province_id = 1869	# Zürich (rp wise also Basel)
			NOT = {
				AND = {
					owned_by = ROOT
					printing_press = 100
					has_production_building_trigger = yes
					has_building = university
					base_production = 18
				}
			}
		}
		trigger = {
			treasury = 400
			innovativeness = 15
			has_institution = printing_press
			1869 ={	# Zürich (rp wise also Basel)
				owned_by = ROOT
				printing_press = 100
				has_production_building_trigger = yes
				has_building = university
				base_production = 18
			}
		}
		effect = {
			add_treasury = -400
			1869 ={	# Zürich (rp wise also Basel)
				change_trade_goods = paper
				add_province_modifier = {
					name = swi_research_printing
					duration = -1
				}
			}
		}
	}

	swi_faculty_of_ballistics = {
		icon = vaud_and_wallis
		required_missions = { swi_print_research }
		position = 6
		provinces_to_highlight = {
			province_id = 1869	# Zürich (rp wise also Basel)
			NOT = {
				AND = {
					owned_by = ROOT
					has_building = university
					base_manpower = 18	# increased compared to doc
				}
			}
			
		}
		trigger = {
			1869 ={	# Zürich (rp wise also Basel)
				owned_by = ROOT
				has_building = university
				base_manpower = 18	# increased compared to doc
			}
			has_country_flag = swi_mercenary_act_passed
		}
		effect = {
			# TODO merc stuff
		}
	}
}
swiss_mountain_missions_3 = {
	slot = 3
	generic = no
	ai = yes
	potential_on_load = {
		 has_dlc = "Emperor"
	}
	potential = {
		tag = SWI
		NOT = { map_setup = map_setup_random }
		has_dlc = "Emperor"
	}
	has_country_shield = yes

	swi_guarantors_of_peace = {
		icon = vaud_and_wallis
		required_missions = { swi_utilize_mountains }
		position = 7
		provinces_to_highlight = {
			has_terrain = mountain
			owned_by = ROOT
			NOT = { fort_level = 3 }
		}
		trigger = {
			num_of_owned_provinces_with = {
				value = 3
				fort_level = 3
				has_terrain = mountain
			}
			has_country_flag = swi_stability_act_passed
		}
		effect = {
			add_country_modifier = {
				name = "swiss_mountains_modifier"
				duration = -1
			}
		}
	}
}